# 💡 CAS Toolbox

The **Consensus Activation Score (CAS)** Toolbox is a utility for computing agreement metrics between activation heatmaps. It's especially valuable in **Explainable AI (XAI)** pipelines to quantify the **consistency** of visual explanations generated by neural network models.

---

## ✨ Features

- 🔍 **Multiple CAS scoring strategies:**
  - 🔥 **Heatmap-based**
    - `region_iou` — Intersection-over-Union (IoU) of thresholded regions
    - `ssim` — Structural Similarity Index (SSIM) between heatmaps
  - 📊 **Vector-based**
    - `pixel-summary-based` — Uses statistical operations (mean, max) on pixel values
    - `latent_consensus` — *Proposed* method to quantify & visualize **class-wise agreement** using latent vectors

- 📂 Supports `.npy`, `.png`, `.jpg`, `.jpeg` heatmap formats  
- 💾 Option to save:
  - Consensus visualizations
  - t-SNE plots of latent representations
- ⚠️ Graceful handling of missing or invalid latent vectors  
- 🗂️ Designed for class-wise structured directories

---

## ⚙️ Installation

Install the required dependencies with:

```bash
pip install numpy pillow scikit-image scikit-learn matplotlib

## Usage

from cas_toolbox.cas import compute_cas_for_dir

cas = compute_cas_for_dir(
    root_dir="LayerCAM-ResNet18-OCTID",                # Directory of heatmaps, organized by class
    strategy="ssim",                                   # Options: mean, union, region_iou, ssim, latent_consensus
    threshold=0.2,                                     # For region_iou strategy
    save_vis_dir="Consensus_maps_LayerCam_ResNet18-OCTID",  
    latent_root="latent_vectors_ResNet18-C8"           # Required only for 'latent_consensus'
)

## Output
print("CAS Scores:")
for cls, score in cas.items():
    print(f"{cls}: {score:.4f}")

## Citation
@misc{cas_toolbox,
  author       = {Abbas Haider et al.},
  title        = {CAS Toolbox: A Tool for Computing Consensus Activation Scores from Heatmaps},
  year         = {2025},
  note         = {\url{https://github.com/your-username/cas_toolbox}}
}

